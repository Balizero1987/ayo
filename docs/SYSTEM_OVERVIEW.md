# SYSTEM OVERVIEW

*Auto-generated by The Scribe on 2025-12-17 12:23:50*

> **Note:** This document is automatically updated. Do not edit manually.

---

## Quick Statistics

- **Total API Routes:** 160
- **Modules:** 260
- **Services:** 79
- **Agents:** 5

---

## API Endpoints Summary

###  (8 endpoints)

**GET:**
- `/`
- `/api/csrf-token`
- `/api/dashboard/stats`
- `/api/intel/critical`
- `/api/intel/stats/{collection}`
- `/api/intel/trends`

**POST:**
- `/api/intel/search`
- `/api/intel/store`

### Audio (2 endpoints)

**POST:**
- `/audio/speech`
- `/audio/transcribe`

### Collective Memory (4 endpoints)

**GET:**
- `/api/collective-memory/facts`
- `/api/collective-memory/stats`

**POST:**
- `/api/collective-memory/contribute`
- `/api/collective-memory/refute`

### Episodic Memory (6 endpoints)

**DELETE:**
- `/api/episodic-memory/events/{event_id}`

**GET:**
- `/api/episodic-memory/context`
- `/api/episodic-memory/stats`
- `/api/episodic-memory/timeline`

**POST:**
- `/api/episodic-memory/events`
- `/api/episodic-memory/extract`

### Oracle INGEST (2 endpoints)

**GET:**
- `/api/oracle/collections`

**POST:**
- `/api/oracle/ingest`

### Oracle v5.3 - Ultra Hybrid (6 endpoints)

**GET:**
- `/api/oracle/drive/test`
- `/api/oracle/gemini/test`
- `/api/oracle/health`
- `/api/oracle/user/profile/{user_email}`

**POST:**
- `/api/oracle/feedback`
- `/api/oracle/query`

### agentic-functions (16 endpoints)

**GET:**
- `/api/agents/analytics/summary`
- `/api/agents/compliance/alerts`
- `/api/agents/compliance/client/{client_id}`
- `/api/agents/ingestion/status`
- `/api/agents/journey/{journey_id}`
- `/api/agents/journey/{journey_id}/next-steps`
- `/api/agents/knowledge-graph/export`
- `/api/agents/status`

**POST:**
- `/api/agents/compliance/track`
- `/api/agents/ingestion/run`
- `/api/agents/journey/create`
- `/api/agents/journey/{journey_id}/step/{step_id}/complete`
- `/api/agents/knowledge-graph/extract`
- `/api/agents/pricing/calculate`
- `/api/agents/research/autonomous`
- `/api/agents/synthesis/cross-oracle`

### agentic-rag (2 endpoints)

**POST:**
- `/api/agentic-rag/query`
- `/api/agentic-rag/stream`

### authentication (6 endpoints)

**GET:**
- `/api/auth/check`
- `/api/auth/csrf-token`
- `/api/auth/profile`

**POST:**
- `/api/auth/login`
- `/api/auth/logout`
- `/api/auth/refresh`

### autonomous-tier1 (9 endpoints)

**GET:**
- `/api/autonomous-agents/executions`
- `/api/autonomous-agents/executions/{execution_id}`
- `/api/autonomous-agents/scheduler/status`
- `/api/autonomous-agents/status`

**POST:**
- `/api/autonomous-agents/client-value-predictor/run`
- `/api/autonomous-agents/conversation-trainer/run`
- `/api/autonomous-agents/knowledge-graph-builder/run`
- `/api/autonomous-agents/scheduler/task/{task_name}/disable`
- `/api/autonomous-agents/scheduler/task/{task_name}/enable`

### conversations (8 endpoints)

**DELETE:**
- `/api/bali-zero/conversations/clear`
- `/api/bali-zero/conversations/{conversation_id}`

**GET:**
- `/api/bali-zero/conversations/history`
- `/api/bali-zero/conversations/list`
- `/api/bali-zero/conversations/memory/context`
- `/api/bali-zero/conversations/stats`
- `/api/bali-zero/conversations/{conversation_id}`

**POST:**
- `/api/bali-zero/conversations/save`

### crm-clients (8 endpoints)

**DELETE:**
- `/api/crm/clients/{client_id}`

**GET:**
- `/api/crm/clients/`
- `/api/crm/clients/by-email/{email}`
- `/api/crm/clients/stats/overview`
- `/api/crm/clients/{client_id}`
- `/api/crm/clients/{client_id}/summary`

**PATCH:**
- `/api/crm/clients/{client_id}`

**POST:**
- `/api/crm/clients/`

### crm-interactions (7 endpoints)

**GET:**
- `/api/crm/interactions/`
- `/api/crm/interactions/client/{client_id}/timeline`
- `/api/crm/interactions/practice/{practice_id}/history`
- `/api/crm/interactions/stats/overview`
- `/api/crm/interactions/{interaction_id}`

**POST:**
- `/api/crm/interactions/`
- `/api/crm/interactions/from-conversation`

### crm-practices (8 endpoints)

**GET:**
- `/api/crm/practices/`
- `/api/crm/practices/active`
- `/api/crm/practices/renewals/upcoming`
- `/api/crm/practices/stats/overview`
- `/api/crm/practices/{practice_id}`

**PATCH:**
- `/api/crm/practices/{practice_id}`

**POST:**
- `/api/crm/practices/`
- `/api/crm/practices/{practice_id}/documents/add`

### crm-shared-memory (4 endpoints)

**GET:**
- `/api/crm/shared-memory/client/{client_id}/full-context`
- `/api/crm/shared-memory/search`
- `/api/crm/shared-memory/team-overview`
- `/api/crm/shared-memory/upcoming-renewals`

### handlers (3 endpoints)

**GET:**
- `/api/handlers/category/{category}`
- `/api/handlers/list`
- `/api/handlers/search`

### health (7 endpoints)

**GET:**
- `/health`
- `/health/`
- `/health/debug/config`
- `/health/detailed`
- `/health/live`
- `/health/metrics/qdrant`
- `/health/ready`

### identity (1 endpoints)

**POST:**
- `/team/login`

### image (1 endpoints)

**POST:**
- `/api/v1/image/generate`

### ingestion (4 endpoints)

**GET:**
- `/api/ingest/stats`

**POST:**
- `/api/ingest/batch`
- `/api/ingest/file`
- `/api/ingest/upload`

### knowledge (2 endpoints)

**GET:**
- `/api/search/health`

**POST:**
- `/api/search/`

### legal-ingestion (3 endpoints)

**GET:**
- `/api/legal/collections/stats`

**POST:**
- `/api/legal/ingest`
- `/api/legal/ingest-batch`

### media (2 endpoints)

**POST:**
- `/media/generate-image`
- `/media/upload`

### memory (8 endpoints)

**DELETE:**
- `/api/memory/{memory_id}`

**GET:**
- `/api/memory/health`
- `/api/memory/stats`

**POST:**
- `/api/memory/embed`
- `/api/memory/init`
- `/api/memory/search`
- `/api/memory/similar`
- `/api/memory/store`

### performance (5 endpoints)

**GET:**
- `/api/performance/cache/stats`
- `/api/performance/metrics`

**POST:**
- `/api/performance/clear-cache`
- `/api/performance/clear-cache/embedding`
- `/api/performance/clear-cache/search`

### sessions (12 endpoints)

**DELETE:**
- `/api/sessions/{session_id}`

**GET:**
- `/api/sessions/analytics/overview`
- `/api/sessions/health`
- `/api/sessions/{session_id}`
- `/api/sessions/{session_id}/export`
- `/api/sessions/{session_id}/info`

**POST:**
- `/api/sessions/cleanup`
- `/api/sessions/create`
- `/api/sessions/{session_id}/extend`
- `/api/sessions/{session_id}/extend-custom`

**PUT:**
- `/api/sessions/{session_id}`
- `/api/sessions/{session_id}/ttl`

### team-activity (9 endpoints)

**GET:**
- `/api/team/activity/monthly`
- `/api/team/activity/weekly`
- `/api/team/export`
- `/api/team/health`
- `/api/team/hours`
- `/api/team/my-status`
- `/api/team/status`

**POST:**
- `/api/team/clock-in`
- `/api/team/clock-out`

### team-analytics (7 endpoints)

**GET:**
- `/api/team-analytics/burnout`
- `/api/team-analytics/optimal-hours`
- `/api/team-analytics/patterns`
- `/api/team-analytics/productivity`
- `/api/team-analytics/team-insights`
- `/api/team-analytics/trends/{user_email}`
- `/api/team-analytics/workload-balance`

---

## Key Modules

### `middleware.error_monitoring`

Error Monitoring Middleware
Captures 4xx/5xx HTTP errors and sends alerts

### `middleware.hybrid_auth`

Hybrid Authentication Middleware - Fail-Closed Implementation
Combines API Key, Cookie JWT, and Header JWT authentication for flexible access control.

Authentication Priority:
1. API Key (X-API-Key h...

### `middleware.rate_limiter`

Rate Limiting Middleware for ZANTARA
Prevents API abuse and ensures fair usage

Features:
- IP-based rate limiting
- User-based rate limiting
- Configurable limits per endpoint
- Redis-backed for dist...

### `migrations.001_fix_missing_tables`

Migration: Fix missing PostgreSQL tables
Date: 2025-10-19
Purpose: Create cultural_knowledge, query_clusters tables and fix memory_facts.id

### `migrations.apply_migration_012`

Apply Migration 012: Fix Production Schema Issues
Adds missing conversation_id column to interactions table

### `migrations.apply_migration_013`

Apply Migration 013: Agentic RAG Tables
Creates tables for Parent-Child Retrieval and Golden Router

### `migrations.migrate_crm_schema`

Apply CRM System Schema Migration
Connects to Fly.io PostgreSQL and applies migration 007

### `migrations.migration_001`

Migration 001: Fix missing PostgreSQL tables
Creates cultural_knowledge and query_clusters tables, fixes memory_facts.id

### `migrations.migration_007`

Migration 007: CRM System Schema
Creates tables for CRM system (team_members, clients, practices, interactions, etc.)

### `migrations.migration_010`

Migration 010: Fix team_members schema alignment
Adds missing columns to align with Python User model

### `migrations.migration_012`

Migration 012: Fix Production Schema Issues
Adds missing conversation_id column to interactions table

### `migrations.migration_013`

Migration 013: Agentic RAG Tables
Creates tables for Parent-Child Retrieval and Golden Router

### `migrations.migration_014`

Migration 014: Knowledge Graph Tables
Creates tables for Knowledge Graph

### `migrations.migration_015`

Migration 015: Add Drive Columns
Adds Google Drive metadata to parent_documents table

### `migrations.migration_016`

Migration 016: Add Summary to Parent Documents
Adds summary column to parent_documents table

### `migrations.migration_018`

Migration 018: Collective Memory System
Creates tables for shared knowledge learned from multiple users

### `migrations.migration_019`

Migration 019: Episodic Memory System
Creates table for storing timeline of user events and experiences

### `migrations.migration_020`

Migration 020: Collective Memory Vector Search
Sets up Qdrant collection and backfills embeddings for existing memories

### `migrations.migration_021`

Migration 021: Memory-Knowledge Graph Integration
Links memory_facts and episodic_memories to kg_entities

### `verify_draft_pattern`

Test Draft-Verify Logic
Simulates a query that might cause hallucinations (fake law) to see if Verifier catches it.

---

*Last updated: 2025-12-17 12:23:50*

For detailed documentation, see [LIVING_ARCHITECTURE.md](./LIVING_ARCHITECTURE.md)